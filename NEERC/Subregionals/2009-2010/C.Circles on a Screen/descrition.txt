Придумал авторское решение но набагал в реализации. Классический алгоритм - найти суммарную длину объединения отрезков.
Надо добавить в библиотеку...
Оказывается алгоритм есть на емаксе)
А баг был в том что забыл в одном месте сдвинуть границу
Кстати я написал свое нахождение суммарной длины, но на емаксе короче, скопирую оттуда в библу.

Вообще задача мне понравилась, наверное во многом потому что я придумал норм решение. Ну и к тому же расширил библу