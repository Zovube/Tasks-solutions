Эта задача оказалась непосильной для меня. Я не придумал решение, а после того как прочитал разбор не понял как его писать.
В итоге я посмотрел автрское решение, но оно оказалось непонятным, его писал Копелиович и использовал какую-то битовую магию.
Понять как ее можно решать мне помогло решение Прищенко, там все понятно и его я и напишу.
Я столкнулся с серьезными трудностями во многом из-за того что задача по сути на динамику. В разборе кстати говорится про bfs
но как его реализовать непонятно...

Важно понять что минимизируется количество действий в худшем случае - именно это и есть значение динамики в решении Богдана

Думаю эта задача достойна того чтобы добавить ее в группу "ДП"

Краткое описание решения: dp[x][y][множество еше не распознанных картинок] = максимальное количество ходов чтобы распознать 
оставшиеся, стартуя отсюда, если действовать оптимально 
При переходе перебираются всевозможные клетки куда сходить
Рекурсивное восстановление ответа, выбор в зависимости от значений посчитанной динамики

Кстати, разобрался с кусочком битовой магии Копелиовича : чтобы проверить что число x является степенью двойки можно проверить
что (x & (x - 1)) == 0, скобки нужны так как приоритет у & больше чем у == и & выполняется позже, кроме того это не работает 
с 0 - важно это помнить